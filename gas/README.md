# 🌊 MoodFlow - Google Apps Script版

会議中の参加者の感情をリアルタイムで記録・分析するシステム

## 特徴

✨ **シンプルなUI**: 1つのHTMLファイルで参加者画面と管理者画面を実現（SPA形式）

📱 **モバイル対応**: スマホでも使いやすいレスポンシブデザイン

🤖 **AI分析**: OpenAI GPT-4o-miniによる会議の自動分析

📊 **自動スライド生成**: Googleスライドで分析結果を可視化

💾 **簡単データ管理**: Googleスプレッドシートにデータを自動保存

🔒 **パスワード保護**: 管理者ダッシュボードはパスワードで保護

## デモ

### 参加者画面
- セッションIDとニックネームを入力
- スライダーで気分スコア（-5〜+5）を選択
- 絵文字とコメントを追加（オプション）
- リアルタイムで送信

### 管理者画面
- パスワードでログイン
- セッションデータの統計を表示
- データ一覧を確認
- ワンクリックでGoogleスライドを生成

## 必要なもの

- Googleアカウント
- OpenAI APIキー（[取得方法](https://platform.openai.com/api-keys)）
- Googleスプレッドシート

## セットアップ

詳細な手順は [SETUP_GUIDE.md](SETUP_GUIDE.md) を参照してください。

### クイックスタート

1. **Googleスプレッドシートを作成**
   - 新しいスプレッドシートを作成
   - URLからスプレッドシートIDを取得

2. **Google Apps Scriptプロジェクトを作成**
   - https://script.google.com/ にアクセス
   - 新しいプロジェクトを作成

3. **ファイルをアップロード**
   - `Code.gs`
   - `OpenAI.gs`
   - `SlidesGenerator.gs`
   - `index.html`

4. **スクリプトプロパティを設定**
   - `OPENAI_API_KEY`: OpenAI APIキー
   - `SPREADSHEET_ID`: スプレッドシートID
   - `ADMIN_PASSWORD`: 管理者パスワード
   - `GOOGLE_SLIDES_FOLDER_ID`: フォルダID（オプション）

5. **デプロイ**
   - デプロイ → 新しいデプロイ → ウェブアプリ
   - アクセスできるユーザー: 全員
   - URLをコピーして参加者に共有

## ファイル構成

```
gas/
├── Code.gs              # メインスクリプト（doGet, API関数）
├── OpenAI.gs            # OpenAI API連携、データ分析
├── SlidesGenerator.gs   # Googleスライド生成
├── index.html           # SPA形式のUI（参加者画面+管理者画面）
├── SETUP_GUIDE.md       # 詳細なセットアップガイド
└── README.md            # このファイル
```

## 使い方

### 参加者として

1. デプロイしたURLにアクセス
2. セッションID（例: `meeting-2024-01-15`）を入力
3. ニックネーム（例: `キリンさん`）を入力
4. 気分スコアを選択
5. 送信

### 管理者として

1. 「管理者ログイン」をクリック
2. パスワードを入力
3. セッションIDを入力して「データを読み込む」
4. 「📊 スライドを生成」で分析レポートを作成

## 生成されるスライド

1. **タイトルスライド**: セッション情報と統計サマリー
2. **会議サマリー**: AIによる全体的な雰囲気とインサイト
3. **統計情報**: 発言数、参加者数、スコア分布
4. **参加者別分析**: 個人ごとの発言数、平均スコア、トレンド
5. **時系列分析**: 5分間隔での感情変化
6. **推奨アクション**: AIによる改善提案

## コスト

### OpenAI API
- モデル: gpt-4o-mini
- 1回の分析: 約$0.001〜$0.01
- 月間100回でも $1 以下

### Google Apps Script
- 完全無料（無料枠で十分）
- 制限内で使用可能

## セキュリティ

- 管理者パスワードはスクリプトプロパティに保存
- 認証トークンはキャッシュに6時間保存
- APIキーはスクリプトプロパティで管理
- デプロイURLは信頼できる参加者のみに共有

## トラブルシューティング

### よくある問題

1. **「認証が必要です」エラー**
   - 管理者ログインが必要です
   - パスワードを再入力してください

2. **「スプレッドシートへの書き込みに失敗」**
   - SPREADSHEET_IDが正しいか確認
   - 権限を承認したか確認

3. **OpenAI APIエラー**
   - APIキーが有効か確認
   - 使用量制限を確認

詳細は [SETUP_GUIDE.md](SETUP_GUIDE.md) のトラブルシューティングセクションを参照してください。

## 技術スタック

- **フロントエンド**: HTML5, CSS3, Vanilla JavaScript
- **バックエンド**: Google Apps Script
- **AI**: OpenAI GPT-4o-mini
- **データストレージ**: Google Spreadsheet
- **出力**: Google Slides

## ライセンス

MIT License

## サポート

問題が発生した場合:
1. [SETUP_GUIDE.md](SETUP_GUIDE.md) を確認
2. Google Apps Scriptの実行ログを確認
3. ブラウザのコンソールを確認（F12）

---

Made with ❤️ for better meetings
