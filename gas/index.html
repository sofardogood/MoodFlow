<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MoodFlow - ä¼šè­°æ„Ÿæƒ…åˆ†æ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    .card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      margin-bottom: 20px;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 10px;
      color: #667eea;
      text-align: center;
    }

    h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: #333;
    }

    .subtitle {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
    }

    .view {
      display: none;
    }

    .view.active {
      display: block;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 500;
    }

    input, textarea, select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #667eea;
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .secondary-btn {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
    }

    .secondary-btn:hover {
      background: #f5f7ff;
    }

    .slider-container {
      margin: 20px 0;
    }

    .slider {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(to right, #ff6b6b, #ffd93d, #6bcf7f);
      outline: none;
      -webkit-appearance: none;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      border: 3px solid #667eea;
    }

    .slider::-moz-range-thumb {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      border: 3px solid #667eea;
    }

    .mood-display {
      text-align: center;
      font-size: 48px;
      margin: 20px 0;
    }

    .mood-value {
      text-align: center;
      font-size: 24px;
      font-weight: 600;
      color: #667eea;
      margin-bottom: 10px;
    }

    .emoticon-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
      margin: 15px 0;
    }

    .emoticon-btn {
      width: 100%;
      padding: 15px 5px;
      font-size: 28px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .emoticon-btn:hover {
      transform: scale(1.1);
      border-color: #667eea;
    }

    .emoticon-btn.selected {
      background: #667eea;
      border-color: #667eea;
      transform: scale(1.1);
    }

    .history-item {
      padding: 15px;
      background: #f5f7ff;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .history-time {
      font-size: 12px;
      color: #999;
      margin-bottom: 5px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin: 20px 0;
    }

    .stat-card {
      background: #f5f7ff;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #667eea;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 14px;
      color: #666;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }

    .data-table th,
    .data-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }

    .data-table th {
      background: #f5f7ff;
      font-weight: 600;
      color: #667eea;
    }

    .message {
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      text-align: center;
    }

    .message.success {
      background: #d4edda;
      color: #155724;
    }

    .message.error {
      background: #f8d7da;
      color: #721c24;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: #667eea;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .nav-buttons {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .nav-buttons button {
      flex: 1;
    }

    @media (max-width: 600px) {
      .emoticon-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- å‚åŠ è€…å…¥åŠ›ç”»é¢ -->
    <div id="participantView" class="view active">
      <div class="card">
        <h1>ğŸŒŠ MoodFlow</h1>
        <p class="subtitle">ä¼šè­°ä¸­ã®æ„Ÿæƒ…ã‚’è¨˜éŒ²ã—ã¾ã—ã‚‡ã†</p>

        <div id="participantMessage"></div>

        <div class="form-group">
          <label>ã‚»ãƒƒã‚·ãƒ§ãƒ³ID</label>
          <input type="text" id="sessionId" placeholder="ä¾‹: meeting-2024-01-15">
        </div>

        <div class="form-group">
          <label>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </label>
          <input type="text" id="nickname" placeholder="ä¾‹: ã‚­ãƒªãƒ³ã•ã‚“">
        </div>

        <div class="form-group">
          <label>ä»Šã®æ°—åˆ†ã¯ï¼Ÿ</label>
          <div class="mood-value" id="moodValue">0</div>
          <div class="slider-container">
            <input type="range" min="-5" max="5" value="0" class="slider" id="moodSlider">
          </div>
          <div style="display: flex; justify-content: space-between; font-size: 12px; color: #999;">
            <span>ğŸ˜¢ -5</span>
            <span>ğŸ˜ 0</span>
            <span>ğŸ˜Š +5</span>
          </div>
        </div>

        <div class="form-group">
          <label>çµµæ–‡å­—ã‚’é¸æŠï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
          <div class="emoticon-grid" id="emoticonGrid">
            <button class="emoticon-btn" data-emoticon="ğŸ˜Š">ğŸ˜Š</button>
            <button class="emoticon-btn" data-emoticon="ğŸ˜„">ğŸ˜„</button>
            <button class="emoticon-btn" data-emoticon="ğŸ˜">ğŸ˜</button>
            <button class="emoticon-btn" data-emoticon="ğŸ˜Ÿ">ğŸ˜Ÿ</button>
            <button class="emoticon-btn" data-emoticon="ğŸ˜¢">ğŸ˜¢</button>
            <button class="emoticon-btn" data-emoticon="ğŸ‘">ğŸ‘</button>
            <button class="emoticon-btn" data-emoticon="â¤ï¸">â¤ï¸</button>
            <button class="emoticon-btn" data-emoticon="ğŸ¤”">ğŸ¤”</button>
            <button class="emoticon-btn" data-emoticon="ğŸ’¡">ğŸ’¡</button>
            <button class="emoticon-btn" data-emoticon="ğŸ‰">ğŸ‰</button>
          </div>
        </div>

        <div class="form-group">
          <label>ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</label>
          <textarea id="comment" placeholder="ä»Šã®æ°—æŒã¡ã‚„æ„è¦‹ã‚’è‡ªç”±ã«å…¥åŠ›ã—ã¦ãã ã•ã„"></textarea>
        </div>

        <button onclick="submitMood()" id="submitBtn">é€ä¿¡</button>

        <div class="nav-buttons">
          <button class="secondary-btn" onclick="showAdminLogin()">ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</button>
        </div>

        <div id="historyContainer" style="margin-top: 30px; display: none;">
          <h2>é€ä¿¡å±¥æ­´</h2>
          <div id="history"></div>
        </div>
      </div>
    </div>

    <!-- ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
    <div id="loginView" class="view">
      <div class="card">
        <h1>ğŸ”’ ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³</h1>
        <p class="subtitle">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>

        <div id="loginMessage"></div>

        <div class="form-group">
          <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
          <input type="password" id="adminPassword" placeholder="ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
        </div>

        <button onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>

        <div class="nav-buttons">
          <button class="secondary-btn" onclick="showParticipantView()">å‚åŠ è€…ç”»é¢ã«æˆ»ã‚‹</button>
        </div>
      </div>
    </div>

    <!-- ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
    <div id="adminView" class="view">
      <div class="card">
        <h1>ğŸ“Š ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
        <p class="subtitle">ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèªã¨åˆ†æ</p>

        <div id="adminMessage"></div>

        <div class="form-group">
          <label>ã‚»ãƒƒã‚·ãƒ§ãƒ³ID</label>
          <input type="text" id="adminSessionId" placeholder="ä¾‹: meeting-2024-01-15">
        </div>

        <button onclick="loadSessionData()">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€</button>

        <div id="statsContainer" style="display: none; margin-top: 30px;">
          <h2>çµ±è¨ˆæƒ…å ±</h2>
          <div class="stats-grid" id="stats"></div>
        </div>

        <div id="dataContainer" style="display: none; margin-top: 30px;">
          <h2>ãƒ‡ãƒ¼ã‚¿ä¸€è¦§</h2>
          <div style="overflow-x: auto;">
            <table class="data-table" id="dataTable">
              <thead>
                <tr>
                  <th>æ™‚åˆ»</th>
                  <th>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ </th>
                  <th>ã‚¹ã‚³ã‚¢</th>
                  <th>çµµæ–‡å­—</th>
                  <th>ã‚³ãƒ¡ãƒ³ãƒˆ</th>
                </tr>
              </thead>
              <tbody id="dataBody"></tbody>
            </table>
          </div>

          <button onclick="generateSlides()" id="generateBtn" style="margin-top: 20px;">
            ğŸ“Š ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ç”Ÿæˆ
          </button>
        </div>

        <div class="nav-buttons">
          <button class="secondary-btn" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentEmoticon = '';
    let authToken = '';
    let currentSessionData = [];

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚
    window.onload = function() {
      // LocalStorageã‹ã‚‰å€¤ã‚’å¾©å…ƒ
      const savedSessionId = localStorage.getItem('moodflow_session_id');
      const savedNickname = localStorage.getItem('moodflow_nickname');

      if (savedSessionId) document.getElementById('sessionId').value = savedSessionId;
      if (savedNickname) document.getElementById('nickname').value = savedNickname;

      // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
      document.getElementById('moodSlider').addEventListener('input', function(e) {
        document.getElementById('moodValue').textContent = e.target.value;
      });

      // çµµæ–‡å­—é¸æŠ
      document.querySelectorAll('.emoticon-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          document.querySelectorAll('.emoticon-btn').forEach(b => b.classList.remove('selected'));
          this.classList.add('selected');
          currentEmoticon = this.dataset.emoticon;
        });
      });
    };

    // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
    function showView(viewId) {
      document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
      document.getElementById(viewId).classList.add('active');
    }

    function showParticipantView() {
      showView('participantView');
    }

    function showAdminLogin() {
      showView('loginView');
    }

    function showAdminView() {
      showView('adminView');
    }

    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    function showMessage(elementId, message, type) {
      const el = document.getElementById(elementId);
      el.innerHTML = `<div class="message ${type}">${message}</div>`;
      setTimeout(() => { el.innerHTML = ''; }, 5000);
    }

    function showLoading(elementId) {
      const el = document.getElementById(elementId);
      el.innerHTML = '<div class="loading"><div class="spinner"></div>å‡¦ç†ä¸­...</div>';
    }

    // æ„Ÿæƒ…ãƒ‡ãƒ¼ã‚¿é€ä¿¡
    function submitMood() {
      const sessionId = document.getElementById('sessionId').value.trim();
      const nickname = document.getElementById('nickname').value.trim();
      const moodScore = parseInt(document.getElementById('moodSlider').value);
      const comment = document.getElementById('comment').value.trim();

      if (!sessionId || !nickname) {
        showMessage('participantMessage', 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¨ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
        return;
      }

      // LocalStorageã«ä¿å­˜
      localStorage.setItem('moodflow_session_id', sessionId);
      localStorage.setItem('moodflow_nickname', nickname);

      const data = {
        sessionId: sessionId,
        nickname: nickname,
        moodScore: moodScore,
        comment: comment,
        emoticon: currentEmoticon
      };

      showLoading('participantMessage');
      document.getElementById('submitBtn').disabled = true;

      google.script.run
        .withSuccessHandler(function(result) {
          document.getElementById('submitBtn').disabled = false;

          if (result.success) {
            showMessage('participantMessage', 'âœ… é€ä¿¡ã—ã¾ã—ãŸï¼', 'success');

            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('moodSlider').value = 0;
            document.getElementById('moodValue').textContent = '0';
            document.getElementById('comment').value = '';
            document.querySelectorAll('.emoticon-btn').forEach(b => b.classList.remove('selected'));
            currentEmoticon = '';

            // å±¥æ­´ã«è¿½åŠ 
            addToHistory(data, result.timestamp);
          } else {
            showMessage('participantMessage', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + result.error, 'error');
          }
        })
        .withFailureHandler(function(error) {
          document.getElementById('submitBtn').disabled = false;
          showMessage('participantMessage', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
        })
        .submitMood(data);
    }

    // å±¥æ­´ã«è¿½åŠ 
    function addToHistory(data, timestamp) {
      const historyContainer = document.getElementById('historyContainer');
      const history = document.getElementById('history');

      historyContainer.style.display = 'block';

      const time = new Date(timestamp).toLocaleTimeString('ja-JP');
      const item = document.createElement('div');
      item.className = 'history-item';
      item.innerHTML = `
        <div class="history-time">${time}</div>
        <div><strong>${data.nickname}</strong> - ã‚¹ã‚³ã‚¢: ${data.moodScore} ${data.emoticon}</div>
        ${data.comment ? `<div style="margin-top: 5px; color: #666;">${data.comment}</div>` : ''}
      `;

      history.insertBefore(item, history.firstChild);

      // æœ€æ–°5ä»¶ã®ã¿è¡¨ç¤º
      while (history.children.length > 5) {
        history.removeChild(history.lastChild);
      }
    }

    // ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³
    function login() {
      const password = document.getElementById('adminPassword').value;

      if (!password) {
        showMessage('loginMessage', 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
        return;
      }

      showLoading('loginMessage');

      google.script.run
        .withSuccessHandler(function(result) {
          if (result.success) {
            authToken = result.token;
            showMessage('loginMessage', 'âœ… ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã—ãŸ', 'success');
            setTimeout(() => {
              showAdminView();
              document.getElementById('loginMessage').innerHTML = '';
            }, 1000);
          } else {
            showMessage('loginMessage', 'âŒ ' + result.error, 'error');
          }
        })
        .withFailureHandler(function(error) {
          showMessage('loginMessage', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
        })
        .adminLogin(password);
    }

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
    function logout() {
      authToken = '';
      document.getElementById('adminPassword').value = '';
      showParticipantView();
    }

    // ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
    function loadSessionData() {
      const sessionId = document.getElementById('adminSessionId').value.trim();

      if (!sessionId) {
        showMessage('adminMessage', 'ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
        return;
      }

      if (!authToken) {
        showMessage('adminMessage', 'èªè¨¼ãŒå¿…è¦ã§ã™', 'error');
        return;
      }

      showLoading('adminMessage');

      google.script.run
        .withSuccessHandler(function(result) {
          document.getElementById('adminMessage').innerHTML = '';

          if (result.success) {
            currentSessionData = result.data;

            if (result.data.length === 0) {
              showMessage('adminMessage', 'ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ', 'error');
              document.getElementById('statsContainer').style.display = 'none';
              document.getElementById('dataContainer').style.display = 'none';
              return;
            }

            displayStats(result.data);
            displayData(result.data);

            document.getElementById('statsContainer').style.display = 'block';
            document.getElementById('dataContainer').style.display = 'block';
          } else {
            showMessage('adminMessage', 'âŒ ' + result.error, 'error');
          }
        })
        .withFailureHandler(function(error) {
          showMessage('adminMessage', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
        })
        .getSessionData(sessionId, authToken);
    }

    // çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
    function displayStats(data) {
      const scores = data.map(d => d.moodScore);
      const total = scores.length;
      const sum = scores.reduce((a, b) => a + b, 0);
      const avg = sum / total;
      const positive = scores.filter(s => s > 0).length;
      const participants = new Set(data.map(d => d.nickname)).size;

      const statsHtml = `
        <div class="stat-card">
          <div class="stat-value">${total}</div>
          <div class="stat-label">ç·ç™ºè¨€æ•°</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${participants}</div>
          <div class="stat-label">å‚åŠ è€…æ•°</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${avg.toFixed(2)}</div>
          <div class="stat-label">å¹³å‡ã‚¹ã‚³ã‚¢</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${((positive/total)*100).toFixed(1)}%</div>
          <div class="stat-label">ãƒã‚¸ãƒ†ã‚£ãƒ–ç‡</div>
        </div>
      `;

      document.getElementById('stats').innerHTML = statsHtml;
    }

    // ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ã‚’è¡¨ç¤º
    function displayData(data) {
      const tbody = document.getElementById('dataBody');
      tbody.innerHTML = '';

      data.forEach(d => {
        const row = tbody.insertRow();
        const time = new Date(d.timestamp).toLocaleTimeString('ja-JP');

        row.innerHTML = `
          <td>${time}</td>
          <td>${d.nickname}</td>
          <td>${d.moodScore}</td>
          <td>${d.emoticon}</td>
          <td>${d.comment}</td>
        `;
      });
    }

    // ã‚¹ãƒ©ã‚¤ãƒ‰ç”Ÿæˆ
    function generateSlides() {
      if (currentSessionData.length === 0) {
        showMessage('adminMessage', 'ãƒ‡ãƒ¼ã‚¿ã‚’å…ˆã«èª­ã¿è¾¼ã‚“ã§ãã ã•ã„', 'error');
        return;
      }

      const sessionId = document.getElementById('adminSessionId').value.trim();

      showLoading('adminMessage');
      document.getElementById('generateBtn').disabled = true;

      google.script.run
        .withSuccessHandler(function(result) {
          document.getElementById('generateBtn').disabled = false;

          if (result.success) {
            showMessage('adminMessage',
              `âœ… ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼<br><a href="${result.slideUrl}" target="_blank" style="color: #667eea;">ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’é–‹ã</a>`,
              'success');
          } else {
            showMessage('adminMessage', 'âŒ ' + result.error, 'error');
          }
        })
        .withFailureHandler(function(error) {
          document.getElementById('generateBtn').disabled = false;
          showMessage('adminMessage', 'âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message, 'error');
        })
        .generateSlides(sessionId, currentSessionData, authToken);
    }
  </script>
</body>
</html>
